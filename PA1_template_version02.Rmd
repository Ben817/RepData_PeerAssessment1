---
title: 'Reproducible Research: Peer Assessment 1'
output:
html_document:
keep_md: yes
pdf_document: default
word_document: default

---


### Loading and preprocessing the data
Change working directory and load the data.
```{r,echo=TRUE}
library(ggplot2)
library(xtable)
library(scales) #To be able to format time in ggplots
setwd("~/Documents/Diverse/Coursera Reproducible Research /Peer Assesment 1/Peeras1/RepData_PeerAssessment1/")
df <- read.csv("activity.csv") #Read and convert to data.table
df$date.new <- strptime(paste(as.character(df$date),sprintf("%04.f",df$interval)),format = "%Y-%m-%d %H%M") #Create a new date column in format POSIX
df$time <- strptime(sprintf("%04.f",df$interval),format = "%H%M") #Create a new date column in format POSIX

```

### What is mean total number of steps taken per day?
Below is the code to produce a histogram on number of steps per day.
```{r,echo=TRUE}
df.perday <- aggregate(steps~date,df,sum)
qplot(steps,data=df.perday,geom="histogram",ylim=c(0,10),xlab="Number of steps per day",ylab="Count",binwidth=500)
summary(df.perday)
```

Here the the code for producing the mean and average total number of steps per day.
```{r,echo=TRUE,results='asis'}
steps.median <- median(df.perday$steps)
steps.mean <- mean(df.perday$steps)
p <- xtable(data.frame("Median number of steps per day"=steps.median,"Mean number of steps per day"=steps.mean))
print(p,typ="html")
```

### What is the average daily activity pattern?
```{r,echo=TRUE}
steps.mean.per.day <- aggregate(steps~interval,df,mean)
steps.mean.per.day$hour <- strptime(sprintf("%04.f",steps.mean.per.day$interval),format = "%H%M") #Create a new date column in format POSIX
steps.mean.per.day$hour <- as.POSIXct(steps.mean.per.day$hour)
steps.max.count <- steps.mean.per.day[which.max(steps.mean.per.day$steps),]$steps
steps.max.count <- sprintf("%.1f",steps.max.count) #formatting
steps.max.hour <- steps.mean.per.day[which.max(steps.mean.per.day$steps),]$hour
steps.max.hour <- format(steps.max.hour,"%H:%M")
p <- ggplot(steps.mean.per.day,aes(hour,steps)) + geom_line(size=.3)
p <- p + scale_x_datetime(breaks = date_breaks("2 hour"),labels = date_format("%H:%m"))
p <- p + labs(list(title="Average number of steps per 5 minutes \n for the whole measurement period",y="Average number of steps per 5 minutes",x="Time"))
p
```

The 5-minute interval that contains most average number of steps is **`r steps.max.hour`**. This interval have on average **`r steps.max.count`** steps.

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
